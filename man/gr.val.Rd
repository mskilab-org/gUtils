% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gUtils.R
\name{gr.val}
\alias{gr.val}
\title{Annotate \code{GRanges} with values from another \code{GRanges}}
\usage{
gr.val(
  query,
  target,
  val = NULL,
  mean = TRUE,
  weighted = mean,
  na.rm = FALSE,
  by = NULL,
  by.prefix = val,
  merge = FALSE,
  FUN = NULL,
  default.val = NA,
  max.slice = Inf,
  mc.cores = 1,
  sep = ", ",
  verbose = FALSE,
  ...
)
}
\arguments{
\item{query}{\code{GRanges} of query ranges whose \code{val} column we will populate with aggregated values of \code{target}}

\item{target}{\code{GRanges} of target ranges that already have "val" column populated}

\item{val}{If a character field: then aggregation will paste together the (unique), overlapping values, collapsing by comma. (default = NULL)}

\item{mean}{boolean If \code{FALSE} then will return sum instead of mean, only applies if target \code{val} column is numeric. (default = TRUE)}

\item{weighted}{Calculate a weighted mean. If \code{FALSE}, calculates unweighted mean. (default = 'mean')}

\item{na.rm}{boolean Remove NA values when calulating means. only applies if val column of target is numeric (default = FALSE)}

\item{by}{scalar character, specifies additional "by" column of query AND target that will be used to match up query and target pairs (i.e. in addition to pure GRanges overlap). (default = NULL)}

\item{by.prefix}{Choose a set of \code{val} fields by a shared prefix. (default = 'val')}

\item{merge}{boolean If merge = FALSE then will cross every range in query with every level of "by" in target (and create data matrix), otherwise will assume query has "by" and merge only ranges that have matching "by" values in both query and target (default = FALSE)}

\item{FUN}{Optional different function to call than mean. Takes two arguments (value, na.rm = TRUE) if weighted = FALSE, and three (value, width, na.rm = TRUE) if weighted = TRUE. (default = NULL)}

\item{default.val}{If no hit in \code{target} found in \code{query}, fill output \code{val} field with this value. (default = NA)}

\item{max.slice}{integer Maximum number of query ranges to consider in one memory chunk. (default = Inf)}

\item{mc.cores}{integer Number of cores to use when running in chunked mode (default = 1)}

\item{sep}{string Specifies character to use as separator when aggregating character "vals" from target, only applies if target is character (default = ', ')}

\item{verbose}{boolean Increase the verbosity of the output (default = FALSE)}

\item{...}{Additional arguments to be sent to \code{\link{gr.findoverlaps}}.}
}
\value{
\code{query} with the \code{val} field populated
}
\description{
Annotates \code{GRanges} in \code{query} with aggregated values of \code{GRanges} in \code{target} in field \code{val}.
If \code{val} is numeric: given \code{target} with value column \code{target} representing ranged data
(i.e. segment intensities), thn computes the value
in each \code{query} \code{GRanges} as the weighted mean of its intersection with target
(ie the target values weighted by the width of the intersections).

Applications include (among others):
\itemize{
\item Querying the average value of target across a given query interval (e.g. exon to gene pileup)
\item recasting a high res tiling in terms of low res intervals.
}
Usually query intervals are bigger than the target intervals.
}
\note{
\code{query} and \code{target} can be \code{GRangesList} object, in which case val will refer to \code{GRangesList} level values fields
}
\author{
Marcin Imielinski
}
